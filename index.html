<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AOAWOW 專業庫存管理系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom": "https://esm.sh/react-dom@^19.2.3",
    "react-dom/client": "https://esm.sh/react-dom@^19.2.3/client",
    "@google/genai": "https://esm.sh/@google/genai@^1.35.0",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/"
  }
}
</script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; overflow-x: hidden; }
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .custom-shadow { shadow-xl shadow-slate-200/50; }
    </style>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useMemo, useCallback } from 'react';
        import { createRoot } from 'react-dom/client';
        import { GoogleGenAI } from "@google/genai";

        // --- 分類與數據 ---
        const Category = {
            AIR_DRIED: '風乾零食',
            FREEZE_DRIED: '凍乾零食',
            SUPPLIES: '用品'
        };

        const INITIAL_PRODUCTS = [
            // --- 風乾零食 (安全庫存: 10) ---
            { id: 'ad-1', category: Category.AIR_DRIED, name: '貓咪抗拒不了貓草餅乾', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-2', category: Category.AIR_DRIED, name: '無雞不可，經典雞胸肉乾', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-3', category: Category.AIR_DRIED, name: '我愛吃鴨鴨，鴨胸肉乾', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-4', category: Category.AIR_DRIED, name: '喀滋喀滋鴨氣管', wholesalePrice: 137, retailPrice: 210, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-5', category: Category.AIR_DRIED, name: '控制熱量好選擇，鴨鴨繞南瓜', wholesalePrice: 169, retailPrice: 260, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-6', category: Category.AIR_DRIED, name: '控制熱量好選擇，雞雞繞南瓜', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-7', category: Category.AIR_DRIED, name: '夢幻星星零食，秋葵鴨肉肉', wholesalePrice: 169, retailPrice: 260, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-8', category: Category.AIR_DRIED, name: '夢幻星星零食，秋葵雞肉肉', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-9', category: Category.AIR_DRIED, name: '補充膳食纖維，小雞繞紅蘿蔔', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-10', category: Category.AIR_DRIED, name: '健康肉餅，黃金薑黃雞肉餅', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-11', category: Category.AIR_DRIED, name: '健康肉餅，黃金薑黃鴨肉餅', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-12', category: Category.AIR_DRIED, name: '營養均衡，紅藜麥鴨肉條', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-13', category: Category.AIR_DRIED, name: '營養均衡，紅藜麥雞肉條', wholesalePrice: 130, retailPrice: 200, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-14', category: Category.AIR_DRIED, name: '牛肉塊 Beef Chunks', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-15', category: Category.AIR_DRIED, name: '藍莓芝士雞肉餅', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-16', category: Category.AIR_DRIED, name: '蘋果雞肉餅', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-17', category: Category.AIR_DRIED, name: '迷迭香牛肉餅', wholesalePrice: 137, retailPrice: 210, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-18', category: Category.AIR_DRIED, name: '羅勒雞肉條', wholesalePrice: 130, retailPrice: 200, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-19', category: Category.AIR_DRIED, name: '百里香鴨肉', wholesalePrice: 137, retailPrice: 210, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-20', category: Category.AIR_DRIED, name: '經典牛筋片', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-21', category: Category.AIR_DRIED, name: '丁香魚小魚乾', wholesalePrice: 117, retailPrice: 180, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-22', category: Category.AIR_DRIED, name: '鬆餅雞肉肉-芝芝藍莓', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-23', category: Category.AIR_DRIED, name: '鬆餅雞肉肉-蔬菜', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-24', category: Category.AIR_DRIED, name: '鬆餅雞肉肉-鴨鴨芝芝藍莓', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'ad-25', category: Category.AIR_DRIED, name: '雞肉鬆鬆', wholesalePrice: 130, retailPrice: 200, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },

            // --- 凍乾零食 (安全庫存: 10) ---
            { id: 'fd-1', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，雞小方', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-2', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，雞大排', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-3', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，雞小胗', wholesalePrice: 137, retailPrice: 210, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-4', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，雞皇冠', wholesalePrice: 137, retailPrice: 210, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-5', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，雞細條', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-6', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，鴨細條', wholesalePrice: 182, retailPrice: 280, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-7', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，脆鴨酥', wholesalePrice: 137, retailPrice: 210, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-8', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，鴨小舌', wholesalePrice: 163, retailPrice: 250, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-9', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，牛小方', wholesalePrice: 182, retailPrice: 280, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-10', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，羊小方', wholesalePrice: 182, retailPrice: 280, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-11', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，鮭小方', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-12', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，鮭大排', wholesalePrice: 195, retailPrice: 300, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-13', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，丁小魚', wholesalePrice: 182, retailPrice: 280, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-14', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，小蝦蝦', wholesalePrice: 182, retailPrice: 280, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-15', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，活力羊菜方', wholesalePrice: 221, retailPrice: 340, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-16', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，強健牛菜方', wholesalePrice: 221, retailPrice: 340, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-17', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，腸胃雞菜方', wholesalePrice: 221, retailPrice: 340, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-18', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，元氣鴨菜方', wholesalePrice: 221, retailPrice: 340, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },
            { id: 'fd-19', category: Category.FREEZE_DRIED, name: '嗷嗚原形脆，蔬菜纖方', wholesalePrice: 208, retailPrice: 320, currentStock: 0, safetyStock: 10, lastWeekStock: 0 },

            // --- 用品 (安全庫存: 5) ---
            { id: 'sp-1', category: Category.SUPPLIES, name: '狗狗慢食墊-蜜桃粉', wholesalePrice: 200, retailPrice: 310, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-2', category: Category.SUPPLIES, name: '狗狗慢食墊-石灰藍', wholesalePrice: 200, retailPrice: 310, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-3', category: Category.SUPPLIES, name: '狗狗慢食墊-蜂蜜黃', wholesalePrice: 200, retailPrice: 310, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-4', category: Category.SUPPLIES, name: '狗狗慢食墊-灰草綠', wholesalePrice: 200, retailPrice: 310, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-5', category: Category.SUPPLIES, name: '貓薄荷魚玩具', wholesalePrice: 90, retailPrice: 150, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-6', category: Category.SUPPLIES, name: '冰淇淋綿綿球', wholesalePrice: 250, retailPrice: 350, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-7', category: Category.SUPPLIES, name: '矽膠吸盤餐盤附勺子-小鴨黃', wholesalePrice: 200, retailPrice: 425, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-8', category: Category.SUPPLIES, name: '矽膠吸盤餐盤附勺子-寶寶藍', wholesalePrice: 200, retailPrice: 425, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-9', category: Category.SUPPLIES, name: '矽膠吸盤餐盤附勺子-蜜桃粉', wholesalePrice: 200, retailPrice: 425, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-10', category: Category.SUPPLIES, name: '矽膠吸盤餐盤附勺子-煙灰綠', wholesalePrice: 200, retailPrice: 425, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-11', category: Category.SUPPLIES, name: '矽膠吸盤餐盤-奶白', wholesalePrice: 200, retailPrice: 425, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-12', category: Category.SUPPLIES, name: '牽繩-大狗狗-粉-140cm/2cm', wholesalePrice: 450, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-13', category: Category.SUPPLIES, name: '牽繩-大狗狗-藍', wholesalePrice: 450, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-14', category: Category.SUPPLIES, name: '牽繩-大狗狗-黑加侖', wholesalePrice: 450, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-15', category: Category.SUPPLIES, name: '牽繩-大狗狗-黑', wholesalePrice: 450, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-16', category: Category.SUPPLIES, name: '牽繩-大狗狗-紫', wholesalePrice: 450, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-17', category: Category.SUPPLIES, name: '牽繩-大狗狗-橘', wholesalePrice: 450, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-18', category: Category.SUPPLIES, name: '牽繩-大狗狗-綠', wholesalePrice: 450, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-19', category: Category.SUPPLIES, name: '牽繩-小狗狗-咖啡色-150cm/8mm', wholesalePrice: 600, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-20', category: Category.SUPPLIES, name: '牽繩-小狗狗-紫色', wholesalePrice: 600, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-21', category: Category.SUPPLIES, name: '牽繩-小狗狗-綠色', wholesalePrice: 600, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-22', category: Category.SUPPLIES, name: '短牽繩-大狗狗-粉 70cm', wholesalePrice: 400, retailPrice: 620, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-23', category: Category.SUPPLIES, name: '短牽繩-大狗狗-藍', wholesalePrice: 400, retailPrice: 620, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-24', category: Category.SUPPLIES, name: '短牽繩-大狗狗-紫', wholesalePrice: 400, retailPrice: 620, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-25', category: Category.SUPPLIES, name: '短牽繩-大狗狗-黑', wholesalePrice: 400, retailPrice: 620, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-26', category: Category.SUPPLIES, name: '防暴衝胸背-黑S', wholesalePrice: 500, retailPrice: 1200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-27', category: Category.SUPPLIES, name: '防暴衝胸背-黑M', wholesalePrice: 500, retailPrice: 1200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-28', category: Category.SUPPLIES, name: '防暴衝胸背-黑L', wholesalePrice: 500, retailPrice: 1200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-29', category: Category.SUPPLIES, name: '手工逗貓棒 替換頭１', wholesalePrice: 80, retailPrice: 250, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-30', category: Category.SUPPLIES, name: '零食保鮮罐-淺灰粉-S-200ml', wholesalePrice: 180, retailPrice: 290, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-31', category: Category.SUPPLIES, name: '零食保鮮罐-淺灰粉-M-300ml', wholesalePrice: 190, retailPrice: 390, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-32', category: Category.SUPPLIES, name: '零食保鮮罐-淺灰粉-L-600ml', wholesalePrice: 200, retailPrice: 490, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-33', category: Category.SUPPLIES, name: '零食保鮮罐-芥末黃-S', wholesalePrice: 180, retailPrice: 290, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-34', category: Category.SUPPLIES, name: '零食保鮮罐-芥末黃-M', wholesalePrice: 190, retailPrice: 390, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-35', category: Category.SUPPLIES, name: '零食保鮮罐-芥末黃-L', wholesalePrice: 200, retailPrice: 490, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-36', category: Category.SUPPLIES, name: '零食保鮮罐-嫩草綠-S', wholesalePrice: 180, retailPrice: 290, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-37', category: Category.SUPPLIES, name: '零食保鮮罐-嫩草綠-M', wholesalePrice: 190, retailPrice: 390, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-38', category: Category.SUPPLIES, name: '零食保鮮罐-嫩草綠-L', wholesalePrice: 200, retailPrice: 490, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-39', category: Category.SUPPLIES, name: '零食保鮮罐-淡海藍-S', wholesalePrice: 180, retailPrice: 290, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-40', category: Category.SUPPLIES, name: '零食保鮮罐-淡海藍-M', wholesalePrice: 190, retailPrice: 390, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-41', category: Category.SUPPLIES, name: '零食保鮮罐-淡海藍-L', wholesalePrice: 200, retailPrice: 490, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-42', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-奶酪黄-S', wholesalePrice: 320, retailPrice: 600, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-43', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-奶酪黄-M', wholesalePrice: 350, retailPrice: 650, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-44', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-奶酪黄-L', wholesalePrice: 350, retailPrice: 650, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-45', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-奶酪黄-XL', wholesalePrice: 400, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-46', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-抹茶綠-S', wholesalePrice: 320, retailPrice: 600, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-47', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-抹茶綠-M', wholesalePrice: 350, retailPrice: 650, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-48', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-抹茶綠-L', wholesalePrice: 350, retailPrice: 650, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-49', category: Category.SUPPLIES, name: '錐形伊莉莎白圈-抹茶綠-XL', wholesalePrice: 400, retailPrice: 720, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-50', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-夢幻紫-S', wholesalePrice: 325, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-51', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-夢幻紫-M', wholesalePrice: 345, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-52', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-夢幻紫-L', wholesalePrice: 355, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-53', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-南瓜橙-S', wholesalePrice: 325, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-54', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-南瓜橙-M', wholesalePrice: 345, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-55', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-南瓜橙-L', wholesalePrice: 355, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-56', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-天空藍-S', wholesalePrice: 325, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-57', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-天空藍-M', wholesalePrice: 345, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-58', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-天空藍-L', wholesalePrice: 355, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-59', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-嫩草綠-S', wholesalePrice: 325, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-60', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-嫩草綠-M', wholesalePrice: 345, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-61', category: Category.SUPPLIES, name: '花朵伊莉莎白圈-嫩草綠-L', wholesalePrice: 355, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-62', category: Category.SUPPLIES, name: '自製大狗花朵圈-粉-M', wholesalePrice: 500, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-63', category: Category.SUPPLIES, name: '自製大狗花朵圈-粉-L', wholesalePrice: 650, retailPrice: 820, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-64', category: Category.SUPPLIES, name: '自製大狗花朵圈-粉-XL', wholesalePrice: 780, retailPrice: 960, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-65', category: Category.SUPPLIES, name: '自製大狗花朵圈-粉-XXL', wholesalePrice: 1080, retailPrice: 1200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-66', category: Category.SUPPLIES, name: '自製大狗花朵圈-藍-M', wholesalePrice: 500, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-67', category: Category.SUPPLIES, name: '自製大狗花朵圈-藍-L', wholesalePrice: 650, retailPrice: 820, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-68', category: Category.SUPPLIES, name: '自製大狗花朵圈-藍-XL', wholesalePrice: 780, retailPrice: 960, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-69', category: Category.SUPPLIES, name: '自製大狗花朵圈-藍-XXL', wholesalePrice: 1080, retailPrice: 1200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-70', category: Category.SUPPLIES, name: '自製大狗花朵圈-綠-M', wholesalePrice: 500, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-71', category: Category.SUPPLIES, name: '自製大狗花朵圈-綠-L', wholesalePrice: 650, retailPrice: 820, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-72', category: Category.SUPPLIES, name: '自製大狗花朵圈-綠-XL', wholesalePrice: 780, retailPrice: 960, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-73', category: Category.SUPPLIES, name: '自製大狗花朵圈-綠-XXL', wholesalePrice: 1080, retailPrice: 1200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-74', category: Category.SUPPLIES, name: '甜甜圈陶瓷寵物碗單層奶油白', wholesalePrice: 225, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-75', category: Category.SUPPLIES, name: '甜甜圈陶瓷寵物碗單層小鴨黃', wholesalePrice: 225, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-76', category: Category.SUPPLIES, name: '甜甜圈陶瓷寵物碗單層芋泥紫', wholesalePrice: 225, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-77', category: Category.SUPPLIES, name: '雙頭轉接牽繩-黑', wholesalePrice: 350, retailPrice: 880, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-78', category: Category.SUPPLIES, name: '雙頭轉接牽繩-粉', wholesalePrice: 350, retailPrice: 880, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-79', category: Category.SUPPLIES, name: '雙頭轉接牽繩-紫', wholesalePrice: 350, retailPrice: 880, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-80', category: Category.SUPPLIES, name: '雙頭轉接牽繩-黑白', wholesalePrice: 350, retailPrice: 880, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-81', category: Category.SUPPLIES, name: '棉花糖撿便器-霓虹果醬粉紫', wholesalePrice: 185, retailPrice: 210, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-82', category: Category.SUPPLIES, name: '棉花糖撿便器-抹茶椰林粉白', wholesalePrice: 185, retailPrice: 210, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-83', category: Category.SUPPLIES, name: '棉花糖撿便器-焦糖海鹽藍白', wholesalePrice: 185, retailPrice: 210, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-84', category: Category.SUPPLIES, name: '棉花糖撿便器-銀色', wholesalePrice: 185, retailPrice: 210, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-85', category: Category.SUPPLIES, name: '棉花糖撿便器-黑粉', wholesalePrice: 185, retailPrice: 210, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-86', category: Category.SUPPLIES, name: '超耐咬狗骨頭-紅色', wholesalePrice: 90, retailPrice: 200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-87', category: Category.SUPPLIES, name: '超耐咬狗骨頭-藍色', wholesalePrice: 90, retailPrice: 200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-88', category: Category.SUPPLIES, name: '超耐咬狗骨頭-綠色', wholesalePrice: 90, retailPrice: 200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-89', category: Category.SUPPLIES, name: '超耐咬狗骨頭-紫色', wholesalePrice: 90, retailPrice: 200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-90', category: Category.SUPPLIES, name: '超耐咬狗骨頭-黃色', wholesalePrice: 90, retailPrice: 200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-91', category: Category.SUPPLIES, name: '超耐咬狗骨頭-扣環', wholesalePrice: 90, retailPrice: 200, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-92', category: Category.SUPPLIES, name: 'BITE ME 土撥鼠', wholesalePrice: 580, retailPrice: 880, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-93', category: Category.SUPPLIES, name: 'BITE ME 浣熊', wholesalePrice: 580, retailPrice: 880, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-94', category: Category.SUPPLIES, name: 'BITE ME 松鼠', wholesalePrice: 220, retailPrice: 380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-95', category: Category.SUPPLIES, name: 'BITE ME 老鼠', wholesalePrice: 220, retailPrice: 380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-96', category: Category.SUPPLIES, name: 'BITE ME 曲奇', wholesalePrice: 280, retailPrice: 420, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-97', category: Category.SUPPLIES, name: 'DINGDOG 捲餅', wholesalePrice: 480, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-98', category: Category.SUPPLIES, name: 'DINGDOG 壽司', wholesalePrice: 380, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-99', category: Category.SUPPLIES, name: 'DINGDOG 蔥', wholesalePrice: 320, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-100', category: Category.SUPPLIES, name: 'DINGDOG 薯條', wholesalePrice: 380, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-101', category: Category.SUPPLIES, name: 'DINGDOG 炸蝦', wholesalePrice: 320, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-102', category: Category.SUPPLIES, name: 'DINGDOG 大漢堡', wholesalePrice: 420, retailPrice: 680, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-103', category: Category.SUPPLIES, name: 'DINGDOG 小漢堡', wholesalePrice: 365, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-104', category: Category.SUPPLIES, name: 'DINGDOG 鮪魚罐頭', wholesalePrice: 365, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-105', category: Category.SUPPLIES, name: 'DINGDOG 草莓果醬', wholesalePrice: 380, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-106', category: Category.SUPPLIES, name: 'DINGDOG 橘子果醬', wholesalePrice: 380, retailPrice: 580, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-107', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 粉綠 L', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-108', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 粉綠 XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-109', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 粉綠 2XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-110', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 粉綠 3XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-111', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 粉綠 5XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-112', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 粉綠 6XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-113', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 黑白 L', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-114', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 黑白 XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-115', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 黑白 2XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-116', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 黑白 3XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-117', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 黑白 5XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 },
            { id: 'sp-118', category: Category.SUPPLIES, name: 'OKTK 毛孩衣 黑白 6XL', wholesalePrice: 820, retailPrice: 1380, currentStock: 0, safetyStock: 5, lastWeekStock: 0 }
        ];

        // --- 輔助函式 ---
        const getRocDate = (dateStr) => {
            if (!dateStr) return '';
            const date = new Date(dateStr);
            const year = date.getFullYear() - 1911;
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const day = date.getDate().toString().padStart(2, '0');
            return `${year}年${month}月${day}日`;
        };

        // --- 組件 ---

        const AddProductModal = ({ isOpen, onClose, onAdd }) => {
            const [formData, setFormData] = useState({ name: '', category: Category.AIR_DRIED, wholesalePrice: 0, retailPrice: 0, currentStock: 0 });
            const safetyStock = formData.category === Category.SUPPLIES ? 5 : 10;
            if (!isOpen) return null;

            const handleSubmit = (e) => {
                e.preventDefault();
                if (!formData.name) return;
                onAdd({ id: `custom-${Date.now()}`, ...formData, safetyStock, lastWeekStock: 0 });
                setFormData({ name: '', category: Category.AIR_DRIED, wholesalePrice: 0, retailPrice: 0, currentStock: 0 });
                onClose();
            };

            return React.createElement('div', { className: "fixed inset-0 z-50 flex items-center justify-center p-4 bg-slate-900/60 backdrop-blur-sm animate-in fade-in duration-200" },
                React.createElement('div', { className: "bg-white rounded-[2rem] shadow-2xl w-full max-w-md overflow-hidden transform animate-in zoom-in duration-300" },
                    React.createElement('div', { className: "bg-indigo-600 px-8 py-6 flex justify-between items-center text-white" },
                        React.createElement('h3', { className: "text-xl font-black tracking-tight" }, "新增產品記錄"),
                        React.createElement('button', { onClick: onClose, className: "p-2 hover:bg-white/20 rounded-full transition-colors" }, React.createElement('i', { className: "fas fa-times" }))
                    ),
                    React.createElement('form', { onSubmit: handleSubmit, className: "p-8 space-y-5" },
                        React.createElement('div', null,
                            React.createElement('label', { className: "block text-sm font-black text-slate-700 mb-2 uppercase tracking-widest" }, "產品名稱"),
                            React.createElement('input', { type: "text", required: true, className: "w-full px-5 py-3.5 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-50 outline-none transition-all font-medium", placeholder: "輸入產品全名", value: formData.name, onChange: e => setFormData({...formData, name: e.target.value}) })
                        ),
                        React.createElement('div', { className: "grid grid-cols-2 gap-5" },
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-black text-slate-700 mb-2 uppercase tracking-widest" }, "分類"),
                                React.createElement('select', { className: "w-full px-5 py-3.5 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-50 outline-none bg-white font-medium", value: formData.category, onChange: e => setFormData({...formData, category: e.target.value}) },
                                    Object.values(Category).map(cat => React.createElement('option', { key: cat, value: cat }, cat))
                                )
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-black text-slate-700 mb-2 uppercase tracking-widest" }, "安全庫存"),
                                React.createElement('div', { className: "px-5 py-3.5 bg-slate-100 rounded-2xl text-slate-500 font-black border border-transparent" }, `${safetyStock}`)
                            )
                        ),
                        React.createElement('div', { className: "grid grid-cols-2 gap-5" },
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-black text-slate-700 mb-2 uppercase tracking-widest" }, "批價"),
                                React.createElement('input', { type: "number", className: "w-full px-5 py-3.5 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-50 outline-none font-medium", value: formData.wholesalePrice, onChange: e => setFormData({...formData, wholesalePrice: parseInt(e.target.value) || 0}) })
                            ),
                            React.createElement('div', null,
                                React.createElement('label', { className: "block text-sm font-black text-slate-700 mb-2 uppercase tracking-widest" }, "零售價"),
                                React.createElement('input', { type: "number", className: "w-full px-5 py-3.5 rounded-2xl border border-slate-200 focus:ring-4 focus:ring-indigo-50 outline-none font-medium", value: formData.retailPrice, onChange: e => setFormData({...formData, retailPrice: parseInt(e.target.value) || 0}) })
                            )
                        ),
                        React.createElement('div', { className: "pt-8 flex gap-4" },
                            React.createElement('button', { type: "button", onClick: onClose, className: "flex-1 py-4 rounded-2xl border-2 border-slate-100 font-black text-slate-400 hover:bg-slate-50 transition-all uppercase tracking-widest text-xs" }, "取消"),
                            React.createElement('button', { type: "submit", className: "flex-1 py-4 rounded-2xl bg-indigo-600 text-white font-black shadow-xl shadow-indigo-100 hover:bg-indigo-700 transition-all active:scale-95 uppercase tracking-widest text-xs" }, "確認新增")
                        )
                    )
                )
            );
        };

        const App = () => {
            const [products, setProducts] = useState(() => {
                const saved = localStorage.getItem('aoawow-inventory-final-v1');
                return saved ? JSON.parse(saved) : INITIAL_PRODUCTS;
            });
            const [session, setSession] = useState({ date: new Date().toISOString().split('T')[0], inspector: '管理員' });
            const [searchTerm, setSearchTerm] = useState('');
            const [activeTab, setActiveTab] = useState('全部');
            const [aiAnalysis, setAiAnalysis] = useState(null);
            const [isAnalyzing, setIsAnalyzing] = useState(false);
            const [isModalOpen, setIsModalOpen] = useState(false);

            useEffect(() => {
                localStorage.setItem('aoawow-inventory-final-v1', JSON.stringify(products));
            }, [products]);

            const stats = useMemo(() => products.reduce((acc, p) => ({
                totalItems: acc.totalItems + 1,
                lowStockItems: acc.lowStockItems + (p.currentStock <= p.safetyStock ? 1 : 0),
                totalWholesaleValue: acc.totalWholesaleValue + (p.wholesalePrice * p.currentStock),
                totalRetailValue: acc.totalRetailValue + (p.retailPrice * p.currentStock),
            }), { totalItems: 0, lowStockItems: 0, totalWholesaleValue: 0, totalRetailValue: 0 }), [products]);

            const filteredProducts = products.filter(p => 
                (activeTab === '全部' || p.category === activeTab) && 
                p.name.toLowerCase().includes(searchTerm.toLowerCase())
            );

            const handleUpdateStock = (id, newStock) => {
                setProducts(prev => prev.map(p => p.id === id ? { ...p, currentStock: newStock } : p));
            };

            const handleStartInventory = () => {
                if (confirm('確定要開始新的一週盤點嗎？\n\n系統將會：\n1. 將「目前庫存」複製到「上週庫存」\n2. 將所有品項的「目前庫存」歸零。')) {
                    setProducts(prev => prev.map(p => ({ ...p, lastWeekStock: p.currentStock, currentStock: 0 })));
                    setSession(prev => ({ ...prev, date: new Date().toISOString().split('T')[0] }));
                }
            };

            const handleReset = () => {
                if (confirm('警告：這將會清除所有目前的修改並恢復到初始產品清單。確定要繼續嗎？')) {
                    setProducts(INITIAL_PRODUCTS);
                }
            };

            const handleExport = () => {
                const headers = ['分類', '品名', '批價', '零售價', '目前庫存', '安全庫存', '上週庫存', '狀態'];
                const rows = products.map(p => [
                    p.category, p.name, p.wholesalePrice, p.retailPrice, p.currentStock, p.safetyStock, p.lastWeekStock, 
                    p.currentStock <= p.safetyStock ? '需補貨' : '充足'
                ]);
                const csv = '\ufeff' + [headers.join(','), ...rows.map(r => r.join(','))].join('\n');
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = `AOAWOW_盤點報告_${getRocDate(session.date)}.csv`;
                link.click();
            };

            const handleAI = async () => {
                setIsAnalyzing(true);
                const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });
                const lowStockList = products.filter(p => p.currentStock <= p.safetyStock).map(p => `${p.name}(剩${p.currentStock})`).join(', ');
                const prompt = `我是 AOAWOW 寵物經銷，目前這些品項庫存不足：${lowStockList || '無'}。請根據品牌調性（專業、高端寵物零食）給我專業的採購補貨建議。字數約 150 字，親切專業。`;
                try {
                    const res = await ai.models.generateContent({
                        model: "gemini-3-flash-preview",
                        contents: prompt,
                    });
                    setAiAnalysis(res.text);
                } catch (e) { setAiAnalysis("分析服務目前忙碌中，請稍後再試。"); }
                finally { setIsAnalyzing(false); }
            };

            return React.createElement('div', { className: "min-h-screen flex flex-col bg-[#fbfcfd]" },
                React.createElement(AddProductModal, { isOpen: isModalOpen, onClose: () => setIsModalOpen(false), onAdd: p => setProducts(prev => [p, ...prev]) }),
                
                // Navbar
                React.createElement('nav', { className: "bg-white border-b sticky top-0 z-40 px-8 h-24 flex items-center justify-between shadow-sm" },
                    React.createElement('div', { className: "flex items-center gap-4" },
                        React.createElement('div', { className: "w-14 h-14 bg-indigo-600 rounded-[1.25rem] flex items-center justify-center text-white shadow-2xl shadow-indigo-100" }, React.createElement('i', { className: "fas fa-paw text-2xl" })),
                        React.createElement('div', null,
                            React.createElement('h1', { className: "text-2xl font-[900] tracking-tighter" }, "AOAWOW ", React.createElement('span', { className: "text-indigo-600" }, "庫存管理系統")),
                            React.createElement('p', { className: "text-[10px] text-slate-400 font-black uppercase tracking-[0.3em]" }, "Official Premium Inventory")
                        )
                    ),
                    React.createElement('div', { className: "flex items-center gap-8" },
                        React.createElement('div', { className: "hidden lg:flex flex-col items-end" },
                            React.createElement('div', { className: "flex items-center gap-2 text-sm font-black text-slate-700" }, 
                                React.createElement('i', { className: "fas fa-calendar-check text-indigo-500" }),
                                React.createElement('span', null, getRocDate(session.date))
                            ),
                            React.createElement('div', { className: "flex items-center gap-2 text-[10px] text-slate-400 font-bold mt-1" },
                                React.createElement('i', { className: "fas fa-user-edit" }),
                                React.createElement('input', { type: "text", value: session.inspector, onChange: e => setSession({...session, inspector: e.target.value}), className: "bg-transparent border-none p-0 w-24 outline-none text-right placeholder-slate-300" })
                            )
                        ),
                        React.createElement('button', { onClick: handleReset, className: "text-slate-200 hover:text-red-400 transition-colors" }, React.createElement('i', { className: "fas fa-sync-alt text-lg" }))
                    )
                ),

                React.createElement('main', { className: "max-w-7xl mx-auto w-full px-8 mt-12 space-y-10" },
                    // Header Actions
                    React.createElement('div', { className: "flex flex-col lg:flex-row justify-between items-start lg:items-center gap-8" },
                        React.createElement('div', null,
                            React.createElement('h2', { className: "text-4xl font-black text-slate-800 tracking-tight" }, "庫存盤點中心"),
                            React.createElement('p', { className: "text-slate-400 font-medium mt-2" }, "請清點實體庫存並確實更新系統數據。")
                        ),
                        React.createElement('div', { className: "flex flex-wrap gap-3 w-full lg:w-auto" },
                            React.createElement('button', { onClick: handleStartInventory, className: "flex-1 lg:flex-none bg-emerald-50 text-emerald-700 px-8 py-4 rounded-[1.25rem] font-black flex items-center justify-center gap-3 hover:bg-emerald-100 transition-all active:scale-95 text-sm" }, React.createElement('i', { className: "fas fa-redo-alt" }), "開始新週盤點"),
                            React.createElement('button', { onClick: handleExport, className: "flex-1 lg:flex-none bg-amber-50 text-amber-700 px-8 py-4 rounded-[1.25rem] font-black flex items-center justify-center gap-3 hover:bg-amber-100 transition-all active:scale-95 text-sm" }, React.createElement('i', { className: "fas fa-file-csv" }), "導出 CSV"),
                            React.createElement('button', { onClick: () => setIsModalOpen(true), className: "flex-1 lg:flex-none bg-white border-2 border-indigo-600 text-indigo-600 px-8 py-4 rounded-[1.25rem] font-black flex items-center justify-center gap-3 hover:bg-indigo-50 transition-all active:scale-95 text-sm" }, React.createElement('i', { className: "fas fa-plus" }), "新增品項"),
                            React.createElement('button', { onClick: handleAI, disabled: isAnalyzing, className: "w-full lg:w-auto bg-indigo-600 text-white px-10 py-4 rounded-[1.25rem] font-black flex items-center justify-center gap-3 shadow-2xl shadow-indigo-100 hover:bg-indigo-700 transition-all active:scale-95 disabled:opacity-50 text-sm" }, 
                                isAnalyzing ? React.createElement('i', { className: "fas fa-spinner fa-spin" }) : React.createElement('i', { className: "fas fa-robot" }),
                                isAnalyzing ? "分析中" : "AI 智慧補貨建議"
                            )
                        )
                    ),

                    // AI Suggestion Box
                    aiAnalysis && React.createElement('div', { className: "bg-indigo-50 border border-indigo-100 rounded-[2.5rem] p-10 relative animate-in slide-in-from-top-6 duration-700 shadow-sm" },
                        React.createElement('button', { onClick: () => setAiAnalysis(null), className: "absolute top-8 right-8 text-indigo-200 hover:text-indigo-400 transition-colors" }, React.createElement('i', { className: "fas fa-times-circle text-2xl" })),
                        React.createElement('div', { className: "flex items-center gap-4 mb-6" },
                            React.createElement('div', { className: "w-12 h-12 bg-indigo-600 rounded-2xl flex items-center justify-center text-white shadow-lg" }, React.createElement('i', { className: "fas fa-lightbulb text-xl" })),
                            React.createElement('h4', { className: "text-indigo-900 font-black text-xl" }, "Gemini AI 盤點助手建議報告")
                        ),
                        React.createElement('div', { className: "text-slate-700 leading-relaxed whitespace-pre-wrap pl-10 border-l-4 border-indigo-200 ml-6 text-sm lg:text-base font-medium" }, aiAnalysis)
                    ),

                    // Stats Dashboard
                    React.createElement('div', { className: "grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6" },
                        [
                            { l: '系統總品項', v: stats.totalItems, i: 'fa-box-open', c: 'blue' },
                            { l: '需補貨品項', v: stats.lowStockItems, i: 'fa-bell', c: 'amber', w: stats.lowStockItems > 0 },
                            { l: '庫存批價市值', v: `$${stats.totalWholesaleValue.toLocaleString()}`, i: 'fa-coins', c: 'emerald' },
                            { l: '零售預估總額', v: `$${stats.totalRetailValue.toLocaleString()}`, i: 'fa-wallet', c: 'purple' }
                        ].map(s => React.createElement('div', { key: s.l, className: "bg-white p-8 rounded-[2.5rem] shadow-sm border border-slate-100 flex items-center gap-6 group hover:border-indigo-100 transition-all" },
                            React.createElement('div', { className: `w-16 h-16 bg-${s.c}-50 text-${s.c}-600 rounded-3xl flex items-center justify-center text-3xl group-hover:scale-110 transition-transform duration-500` }, React.createElement('i', { className: `fas ${s.i}` })),
                            React.createElement('div', null,
                                React.createElement('p', { className: "text-[10px] font-black text-slate-400 uppercase tracking-[0.2em] mb-1" }, s.l),
                                React.createElement('p', { className: `text-2xl font-[900] ${s.w ? 'text-amber-600' : 'text-slate-800'}` }, s.v)
                            )
                        ))
                    ),

                    // Filters
                    React.createElement('div', { className: "flex flex-col lg:flex-row gap-5" },
                        React.createElement('div', { className: "flex bg-white p-2 rounded-[1.5rem] shadow-sm border border-slate-100 overflow-x-auto no-scrollbar" },
                            ['全部', '風乾零食', '凍乾零食', '用品'].map(t => React.createElement('button', { 
                                key: t, 
                                onClick: () => setActiveTab(t), 
                                className: `px-10 py-3.5 rounded-2xl text-xs font-black tracking-widest uppercase transition-all whitespace-nowrap ${activeTab === t ? 'bg-indigo-600 text-white shadow-xl shadow-indigo-100' : 'text-slate-400 hover:text-slate-600'}` 
                            }, t))
                        ),
                        React.createElement('div', { className: "relative flex-1" },
                            React.createElement('i', { className: "fas fa-search absolute left-6 top-1/2 -translate-y-1/2 text-slate-300" }),
                            React.createElement('input', { 
                                type: "text", 
                                placeholder: "搜尋品名、貨號或分類...", 
                                value: searchTerm, 
                                onChange: e => setSearchTerm(e.target.value), 
                                className: "w-full pl-16 pr-8 py-5 rounded-[1.5rem] border border-slate-200 outline-none focus:ring-4 focus:ring-indigo-50 transition-all text-sm font-bold shadow-sm" 
                            })
                        )
                    ),

                    // Table Container
                    React.createElement('div', { className: "bg-white rounded-[3rem] shadow-2xl shadow-slate-200/50 border border-slate-100 overflow-hidden mb-12" },
                        React.createElement('div', { className: "overflow-x-auto" },
                            React.createElement('table', { className: "w-full border-collapse" },
                                React.createElement('thead', { className: "bg-slate-50/50 border-b border-slate-100" },
                                    React.createElement('tr', null,
                                        ['分類', '品名', '目前庫存', '安全', '上週', '批價/零售', '狀態'].map(h => React.createElement('th', { key: h, className: "px-8 py-8 text-left text-[10px] font-black text-slate-400 uppercase tracking-[0.3em]" }, h))
                                    )
                                ),
                                React.createElement('tbody', { className: "divide-y divide-slate-50" },
                                    filteredProducts.map(p => {
                                        const isLow = p.currentStock <= p.safetyStock;
                                        return React.createElement('tr', { key: p.id, className: `group hover:bg-slate-50/50 transition-all ${isLow ? 'bg-amber-50/10' : ''}` },
                                            React.createElement('td', { className: "px-8 py-8" }, 
                                                React.createElement('span', { className: `px-3 py-1.5 rounded-xl text-[9px] font-black uppercase tracking-widest ${p.category === '用品' ? 'bg-indigo-50 text-indigo-500' : 'bg-orange-50 text-orange-500'}` }, p.category)
                                            ),
                                            React.createElement('td', { className: "px-8 py-8 max-w-[250px]" },
                                                React.createElement('p', { className: "font-black text-slate-700 text-sm leading-tight" }, p.name)
                                            ),
                                            React.createElement('td', { className: "px-8 py-8" },
                                                React.createElement('div', { className: "flex items-center gap-4" },
                                                    React.createElement('button', { onClick: () => handleUpdateStock(p.id, Math.max(0, p.currentStock - 1)), className: "w-10 h-10 rounded-[0.8rem] bg-slate-50 hover:bg-white border border-slate-100 flex items-center justify-center transition-all active:scale-90 shadow-sm" }, React.createElement('i', { className: "fas fa-minus text-[10px] text-slate-400" })),
                                                    React.createElement('input', { 
                                                        type: "number", 
                                                        value: p.currentStock, 
                                                        onChange: e => handleUpdateStock(p.id, parseInt(e.target.value) || 0), 
                                                        className: "w-14 text-center font-[900] text-xl text-indigo-600 bg-transparent outline-none focus:scale-125 transition-transform" 
                                                    }),
                                                    React.createElement('button', { onClick: () => handleUpdateStock(p.id, p.currentStock + 1), className: "w-10 h-10 rounded-[0.8rem] bg-slate-50 hover:bg-white border border-slate-100 flex items-center justify-center transition-all active:scale-90 shadow-sm" }, React.createElement('i', { className: "fas fa-plus text-[10px] text-slate-400" }))
                                                )
                                            ),
                                            React.createElement('td', { className: "px-8 py-8 text-xs font-black text-slate-300" }, p.safetyStock),
                                            React.createElement('td', { className: "px-8 py-8 text-xs font-black text-slate-300" }, p.lastWeekStock),
                                            React.createElement('td', { className: "px-8 py-8" },
                                                React.createElement('div', { className: "flex flex-col gap-1" },
                                                    React.createElement('span', { className: "text-[10px] font-black text-slate-400" }, `$${p.wholesalePrice}`),
                                                    React.createElement('span', { className: "text-[10px] font-black text-indigo-400" }, `$${p.retailPrice}`)
                                                )
                                            ),
                                            React.createElement('td', { className: "px-8 py-8" },
                                                isLow ? 
                                                React.createElement('div', { className: "flex items-center gap-2 text-red-500" }, 
                                                    React.createElement('span', { className: "w-2 h-2 rounded-full bg-red-500 animate-pulse" }),
                                                    React.createElement('span', { className: "text-[10px] font-[900] tracking-widest uppercase" }, "缺貨")
                                                ) : 
                                                React.createElement('div', { className: "flex items-center gap-2 text-emerald-500" }, 
                                                    React.createElement('span', { className: "w-2 h-2 rounded-full bg-emerald-500" }),
                                                    React.createElement('span', { className: "text-[10px] font-[900] tracking-widest uppercase" }, "充足")
                                                )
                                            )
                                        );
                                    })
                                )
                            )
                        ),
                        filteredProducts.length === 0 && React.createElement('div', { className: "p-32 text-center" },
                            React.createElement('div', { className: "w-24 h-24 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-6" }, React.createElement('i', { className: "fas fa-search text-4xl text-slate-100" })),
                            React.createElement('p', { className: "text-slate-300 font-black uppercase tracking-widest" }, "查無符合條件之產品")
                        )
                    )
                ),

                React.createElement('footer', { className: "mt-auto py-12 text-center border-t border-slate-100 mx-8 flex flex-col items-center gap-4" },
                    React.createElement('div', { className: "w-10 h-10 bg-slate-100 rounded-2xl flex items-center justify-center text-slate-300" }, React.createElement('i', { className: "fas fa-shield-alt" })),
                    React.createElement('p', { className: "text-[9px] font-black text-slate-300 uppercase tracking-[0.4em]" }, "© 2025 AOAWOW PREMIUM PET TREATS OFFICIAL INVENTORY SYSTEM")
                )
            );
        };

        createRoot(document.getElementById('root')).render(React.createElement(App));
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>